(this.webpackJsonpwhiteboard=this.webpackJsonpwhiteboard||[]).push([[0],{11:function(e,t,n){e.exports=n(17)},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(8),c=n.n(i),o=(n(16),n(10)),l=n(0),u=n(2),s=n(3),d=n(6),f=n(9),p=["id","type","position"],x=d.a.generator(),y=function(e,t,n,r,a,i){switch(i){case"line":case"rectangle":return{id:e,x1:t,y1:n,x2:r,y2:a,type:i,roughElement:"line"===i?x.line(t,n,r,a):x.rectangle(t,n,r-t,a-n)};case"pencil":return{id:e,type:i,points:[{x:t,y:n}]};case"text":return{id:e,type:i,x1:t,y1:n,x2:r,y2:a,text:""};default:throw new Error("Type not recognised: ".concat(i))}},g=function(e,t,n,r,a){return Math.abs(e-n)<5&&Math.abs(t-r)<5?a:null},b=function(e,t,n,r,a,i){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,o={x:e,y:t},l={x:n,y:r},u={x:a,y:i},s=m(o,l)-(m(o,u)+m(l,u));return Math.abs(s)<c?"inside":null},h=function(e,t,n){var r=n.type,a=n.x1,i=n.x2,c=n.y1,o=n.y2;switch(r){case"line":var l=b(a,c,i,o,e,t),u=g(e,t,a,c,"start"),s=g(e,t,i,o,"end");return u||s||l;case"rectangle":var d=g(e,t,a,c,"tl"),f=g(e,t,i,c,"tr"),p=g(e,t,a,o,"bl"),x=g(e,t,i,o,"br");return d||f||p||x||(e>=a&&e<=i&&t>=c&&t<=o?"inside":null);case"pencil":return n.points.some((function(r,a){var i=n.points[a+1];return!!i&&null!=b(r.x,r.y,i.x,i.y,e,t,5)}))?"inside":null;case"text":return e>=a&&e<=i&&t>=c&&t<=o?"inside":null;default:throw new Error("Type not recognised: ".concat(r))}},m=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},v=function(e,t,n){return n.map((function(n){return Object(s.a)(Object(s.a)({},n),{},{position:h(e,t,n)})})).find((function(e){return null!==e.position}))},w=function(e,t,n){switch(n.type){case"line":case"rectangle":e.draw(n.roughElement);break;case"pencil":var r=function(e){if(!e.length)return"";var t=e.reduce((function(e,t,n,r){var a=Object(u.a)(t,2),i=a[0],c=a[1],o=Object(u.a)(r[(n+1)%r.length],2),l=o[0],s=o[1];return e.push(i,c,(i+l)/2,(c+s)/2),e}),["M"].concat(Object(l.a)(e[0]),["Q"]));return t.push("Z"),t.join(" ")}(Object(f.a)(n.points));t.fill(new Path2D(r));break;case"text":t.textBaseline="top",t.font="24px sans-serif",t.fillText(n.text,n.x1,n.y1);break;default:throw new Error("Type not recognised: ".concat(n.type))}},O=function(){var e=function(e){var t=Object(r.useState)(0),n=Object(u.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)([e]),o=Object(u.a)(c,2),s=o[0],d=o[1];return[s[a],function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="function"===typeof e?e(s[a]):e;if(t){var r=Object(l.a)(s);r[a]=n,d(r)}else{var c=Object(l.a)(s).slice(0,a+1);d([].concat(Object(l.a)(c),[n])),i((function(e){return e+1}))}},function(){return a>0&&i((function(e){return e-1}))},function(){return a<s.length-1&&i((function(e){return e+1}))}]}([]),t=Object(u.a)(e,4),n=t[0],i=t[1],c=t[2],f=t[3],x=Object(r.useState)("none"),g=Object(u.a)(x,2),b=g[0],h=g[1],m=Object(r.useState)("text"),O=Object(u.a)(m,2),j=O[0],E=O[1],k=Object(r.useState)(null),R=Object(u.a)(k,2),M=R[0],z=R[1],C=Object(r.useRef)();Object(r.useLayoutEffect)((function(){var e=document.getElementById("canvas"),t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);var r=d.a.canvas(e);n.forEach((function(e){"writing"===b&&M.id===e.id||w(r,t,e)}))}),[n,b,M]),Object(r.useEffect)((function(){var e=function(e){(e.metaKey||e.ctrlKey)&&"z"===e.key&&(e.shiftKey?f():c())};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[c,f]),Object(r.useEffect)((function(){var e=C.current;"writing"===b&&(e.focus(),e.value=M.text)}),[b,M]);var S=function(e,t,r,a,c,o,u){var d=Object(l.a)(n);switch(o){case"line":case"rectangle":d[e]=y(e,t,r,a,c,o);break;case"pencil":d[e].points=[].concat(Object(l.a)(d[e].points),[{x:a,y:c}]);break;case"text":var f=document.getElementById("canvas").getContext("2d").measureText(u.text).width;d[e]=Object(s.a)(Object(s.a)({},y(e,t,r,t+f,r+24,o)),{},{text:u.text});break;default:throw new Error("Type not recognised: ".concat(o))}i(d,!0)};return a.a.createElement("div",{style:{overflow:"hidden",height:"100vh",width:"100vw"}},a.a.createElement("center",null,a.a.createElement("div",{style:{marginTop:"9px",position:"fixed"}},a.a.createElement("input",{type:"radio",id:"selection",checked:"selection"===j,onChange:function(){return E("selection")}}),a.a.createElement("label",{htmlFor:"selection",style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"}},"Selection"),a.a.createElement("input",{type:"radio",id:"line",checked:"line"===j,onChange:function(){return E("line")}}),a.a.createElement("label",{htmlFor:"line",style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"}},"Line"),a.a.createElement("input",{type:"radio",id:"rectangle",checked:"rectangle"===j,onChange:function(){return E("rectangle")}}),a.a.createElement("label",{htmlFor:"rectangle",style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"}},"Rectangle"),a.a.createElement("input",{type:"radio",id:"pencil",checked:"pencil"===j,onChange:function(){return E("pencil")}}),a.a.createElement("label",{htmlFor:"pencil",style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"}},"Pencil"),a.a.createElement("input",{type:"radio",id:"text",checked:"text"===j,onChange:function(){return E("text")}}),a.a.createElement("label",{htmlFor:"text",style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"}},"Text"))),a.a.createElement("center",null,a.a.createElement("div",{style:{position:"fixed",bottom:0,padding:10}},a.a.createElement("button",{style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"},onClick:c},"Undo"),a.a.createElement("button",{style:{marginRight:"15px",padding:"8px",borderRadius:"0.5rem",background:"black",color:"azure"},onClick:f},"Redo"))),"writing"===b?a.a.createElement("textarea",{ref:C,onBlur:function(e){var t=M.id,n=M.x1,r=M.y1,a=M.type;h("none"),z(null),S(t,n,r,null,null,a,{text:e.target.value})},style:{position:"fixed",top:M.y1-2,left:M.x1,font:"24px sans-serif",margin:0,padding:0,border:0,outline:0,resize:"auto",overflow:"hidden",whiteSpace:"pre",background:"transparent"}}):null,a.a.createElement("canvas",{id:"canvas",width:window.innerWidth,height:window.innerHeight,onMouseDown:function(e){if("writing"!==b){var t=e.clientX,r=e.clientY;if("selection"===j){var a=v(t,r,n);if(a){if("pencil"===a.type){var c=a.points.map((function(e){return t-e.x})),o=a.points.map((function(e){return r-e.y}));z(Object(s.a)(Object(s.a)({},a),{},{xOffsets:c,yOffsets:o}))}else{var u=t-a.x1,d=r-a.y1;z(Object(s.a)(Object(s.a)({},a),{},{offsetX:u,offsetY:d}))}i((function(e){return e})),"inside"===a.position?h("moving"):h("resizing")}}else{var f=n.length,p=y(f,t,r,t,r,j);i((function(e){return[].concat(Object(l.a)(e),[p])})),z(p),h("text"===j?"writing":"drawing")}}},onMouseMove:function(e){var t=e.clientX,r=e.clientY;if("selection"===j){var a=v(t,r,n);e.target.style.cursor=a?function(e){switch(e){case"tl":case"br":case"start":case"end":return"nwse-resize";case"tr":case"bl":return"nesw-resize";default:return"move"}}(a.position):"default"}if("drawing"===b){var c=n.length-1,u=n[c],d=u.x1,f=u.y1;S(c,d,f,t,r,j)}else if("moving"===b)if("pencil"===M.type){var x=M.points.map((function(e,n){return{x:t-M.xOffsets[n],y:r-M.yOffsets[n]}})),y=Object(l.a)(n);y[M.id]=Object(s.a)(Object(s.a)({},y[M.id]),{},{points:x}),i(y,!0)}else{var g=M.id,h=M.x1,m=M.x2,w=M.y1,O=M.y2,E=M.type,k=M.offsetX,R=M.offsetY,z=m-h,C=O-w,T=t-k,B=r-R,X="text"===E?{text:M.text}:{};S(g,T,B,T+z,B+C,E,X)}else if("resizing"===b){var Y=M.id,F=M.type,L=M.position,I=Object(o.a)(M,p),K=function(e,t,n,r){var a=r.x1,i=r.y1,c=r.x2,o=r.y2;switch(n){case"tl":case"start":return{x1:e,y1:t,x2:c,y2:o};case"tr":return{x1:a,y1:t,x2:e,y2:o};case"bl":return{x1:e,y1:i,x2:c,y2:t};case"br":case"end":return{x1:a,y1:i,x2:e,y2:t};default:return null}}(t,r,L,I),W=K.x1,D=K.y1,J=K.x2,P=K.y2;S(Y,W,D,J,P,F)}},onMouseUp:function(e){var t=e.clientX,r=e.clientY;if(M){if("text"===M.type&&t-M.offsetX===M.x1&&r-M.offsetY===M.y1)return void h("writing");var a=M.id,i=n[a],c=i.id,o=i.type;if(("drawing"===b||"resizing"===b)&&function(e){return["line","rectangle"].includes(e)}(o)){var l=function(e){var t=e.type,n=e.x1,r=e.y1,a=e.x2,i=e.y2;if("rectangle"===t){var c=Math.min(n,a),o=Math.max(n,a);return{x1:c,y1:Math.min(r,i),x2:o,y2:Math.max(r,i)}}return n<a||n===a&&r<i?{x1:n,y1:r,x2:a,y2:i}:{x1:a,y1:i,x2:n,y2:r}}(n[a]),u=l.x1,s=l.y1,d=l.x2,f=l.y2;S(c,u,s,d,f,o)}}"writing"!==b&&(h("none"),z(null))}},"Canvas"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.9a9549a8.chunk.js.map